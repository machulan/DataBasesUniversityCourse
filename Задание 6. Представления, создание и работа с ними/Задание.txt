Представления, создание и работа с ними_ 311
Задача 1 Создание представлений

Отчеты по предметной области, которые было предложено сделать в задании 1 выполнить в форме представлений.  Всего должно быть не менее 3 представлений.

Порядок выполнения:

1. Чтобы создать представление выполните следующие действия:

 - Раскройте узел базы данных , затем узел Представления (Views); отобразится список текущих представлений БД. 

 - Чтобы создать новое представление, в контекстном меню узла Представления (Views) выберите команду Создать представление (New View). Отобразится диалоговое окно Добавить таблицу (Add Table).

- Выберите таблицы, которые следует добавить в представление, и щелкните кнопку Добавить (Add). Выбранный объект будет отображен в области диаграммы окна конструктора запросов в виде плавающей панели со списком столбцов объекта. 

- По окончании работы с диалоговым окном Добавить таблицу (Add Table) щелкните кнопку Закрыть (Close).

- Предоставленные списки столбцов используйте для выбора тех столбцов, которые следует использовать в представлении. Таким образом, создается инструкция SELECT, определяющая представление.

- В поле Filter можете ввести информацию ограничивающую представление (например, месяц  или уровень зарплаты и т.д.):

3. Сохраните представление под именем.

4. Создайте запрос SELECT для проверки того, что представление возвращает только требуемые данные.

5. Посмотрите код созданного представления с помощью процедуры sp_helptext

6. Защита кода – шифрование представлений. Примените оператор WITH ENCRYPTION к Вашему представлению. После выполнения этого оператора предпримем попытку ознакомиться с определением представления с помощью процедуры sp_helptext. Какой результат вы  получили?

 

Задача 2: Создание обновляемого представления

В этом упражнении вы создадите представление, позволяющее изменять данные в зависимых таблицах. В основе создания обновляемого представления лежит простое правило 

– обновление или вставка данных с помощью представления, в котором задана конструкция WITH CHECK OPTION, осуществляется, только если строка, полученная в результате применения этой операции обновления или вставки, соответствует критериям, допускающим ее включение в это представление. Иначе говоря, строка, полученная в результате вставки или обновления, должна соответствовать критериям конструкции WHERE, которая определена в операторе SELECT, лежащем в основе представления.

После создания такого представления выполните вставку в него и посмотрите результаты.

 

Задача 3: Создание индексированного представления

- Установить параметры для поддержки индексированных представлений

SET NUMERIC_ROUNDABORT OFF;

SET ANSI_PADDING, ANSI_WARNINGS, CONCAT_NULL_YIELDS_NULL,

ARITHABORT, QUOTED_IDENTIFIER, ANSI.NULLS ON;

GO

- Создать представления с привязкой к схеме (используя опцию WITH SCHEMABINDING)

- Создать кластерного индекса для представления

- Сравнить производительность индексированного представления с производительностью запроса SELECT, на котором оно основано, для этого можно использовать табличную подсказку noexpend